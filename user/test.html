<!DOCTYPE html>
<html>
<head>
  <title>Test</title>
</head>
<body>
  <form id="assignForm">
    <input type="checkbox" id="assign_all">
    <div id="user_select">
      <select name="user_ids[]" multiple>
        <option value="1">User 1</option>
        <option value="2">User 2</option>
      </select>
    </div>
    <button type="submit">Assign</button>
  </form>

  <script>
    console.log("JS Loaded!");
    document.addEventListener('DOMContentLoaded', function () {
      const assignForm = document.getElementById('assignForm');
      const assignAllCheckbox = document.getElementById('assign_all');
      const userSelectWrapper = document.getElementById('user_select');
      const userSelect = document.querySelector('select[name="user_ids[]"]');

      assignAllCheckbox.addEventListener('change', function () {
        userSelectWrapper.style.display = this.checked ? 'none' : 'block';
      });

      assignForm.addEventListener('submit', function (e) {
        const isAssignAll = assignAllCheckbox.checked;
        const selectedUsers = Array.from(userSelect.selectedOptions);
        console.log("Assign ke semua user?", isAssignAll);
        console.log("User yang dipilih:", selectedUsers.map(opt => opt.value));

        if (!isAssignAll && selectedUsers.length === 0) {
          alert("Pilih minimal satu user sebelum meng-assign tugas.");
          e.preventDefault();
        }
      });
    });
  </script>
</body>
</html>
